"use strict";function _createForOfIteratorHelper(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}!function(t){t(document).ready((function(){if(!t(".jtoc-wrap").length)return!1;t(".joli-color-picker").wpColorPicker({change:function(e,n){t(".joli-info-text").addClass("open")}}),t(".joli-pro .wp-picker-container button").each((function(e,n){t(this).attr("disabled",!0)})),t(".joli-do-submit").on("click",(function(t){document.getElementById("jtoc-settings").dispatchEvent(new Event("submit"))}));var e=t(".jtoc-wrap .joli-nav"),n=t("#tab-settings table.form-table tr"),o=window.location.hash;o.length>0?d("tab-"+o.substr(1)):d(t(e).children().first().attr("id"));var i=!1,a=t("#wpadminbar"),r=t(a).outerHeight(!0),s=t(".joli-header"),c=t(s).offset().top,l=t(document).scrollTop();t(".joli-gopro-notice");function d(o){t(e).find(".joli-nav-item").removeClass("nav-tab-active"),t(e).find("#"+o).addClass("nav-tab-active"),t(n).removeClass("active"),t("#tab-settings table.form-table tr."+o).addClass("active");var i=t("#tab-settings table.form-table"),a=t(".joli-section-desc"),s=t("#tab-settings h2"),d=t(".joli-tab-pane");t(a).hide(),t(i).hide(),t(s).hide(),t(d).hide();var u=s.filter((function(e,n){return t(this).nextAll("table").first().find("tr").hasClass("active")})),f=t(u).map((function(e,n){var o=t(this).next(".joli-section-desc");return t(o).length?t(o)[0]:null})),p=i.filter((function(){return t(this).find("tr").hasClass("active")})),h=d.filter((function(){return t(this).attr("data-key")==o}),o);t(p).show(),t(u).show(),t(f).show(),t(h).show(),"tab-general"==o?t(".joli-quickstart-notice").show():t(".joli-quickstart-notice").hide(),l+r>c&&t("html, body").animate({scrollTop:c-r-15},600,void document)}t(window).on("scroll",(function(){i=!0})),t(window).on("resize",(function(){c=t(s).offset().top,r=t(a).outerHeight(!0)})),setInterval((function(){i&&(i=!1,(l=t(document).scrollTop())+r>c?(t(s).css("position","fixed"),t(s).css("top",r+"px")):(t(s).css("position",""),t(s).css("top","")))}),50),t(".joli-nav-item").on("click",(function(e){d(t(this).attr("id"))}));var u=function(e){var n=t(e).attr("data-linkedfield"),o=t("#check_"+n),i=t(e).prop("checked")?1:0;t(o).val(i);t(e).attr("data-deactivates");if(!t(e).closest("tr").hasClass("joli-pro")){!function(e,n){if(void 0!==e){var o,i=_createForOfIteratorHelper(e.split(","));try{for(i.s();!(o=i.n()).done;){var a=o.value,r=t(".joli-section--"+a);0===n?t(r).addClass("hidden"):t(r).removeClass("hidden")}}catch(t){i.e(t)}finally{i.f()}}}(t(e).attr("data-children-sections"),i);var a=t(e).attr("data-children");if(""===a)return;!function(e,n){if(void 0!==e){var o,i=_createForOfIteratorHelper(e.split(","));try{for(i.s();!(o=i.n()).done;){var a=o.value,r=t(".joli-field--"+a);0===n?t(r).addClass("hidden"):t(r).removeClass("hidden")}}catch(t){i.e(t)}finally{i.f()}}}(a,i)}};t("input:checkbox.joli-checkbox").on("change",(function(){u(this)})),t(document).on("change",".joli-content textarea, .joli-content input, .joli-content select",(function(){t(".joli-info-text").addClass("open")})),t(document).on("change",".joli-content select",(function(){var e=".joli-admin-image-"+t(this).attr("data-selector");if(t(e).length>0){var n=t(this).find(":selected").attr("data-media");t(e).addClass("hidden");var o="#"+t(this).attr("data-selector")+"-"+n;t(o).removeClass("hidden")}})),t(document).on("click","#jtoc_reset_settings",(function(e){var n=t(this).data("prompt");if(!confirm(n))return e.preventDefault(),!1})),t(document).on("click",".joli-post-type-check",(function(e){var n="undefined"!=typeof jtoc_active_post_type?jtoc_active_post_type:"",o=t(this).attr("data-post-type");if(t(this).is(":checked")&&n!==o)return alert("You need to be on the corresponding post type settings page in order to activate its settings."),!1;var i=t(".joli-post-type-check").map((function(e,n){return t(n).is(":checked")?t(n).attr("data-post-type"):null})).toArray().filter((function(t,e){return null!==e}));t.ajax({url:jtocAdmin.ajaxUrl,method:"post",data:{nonce:jtocAdmin.nonce,action:"joli_toc_update_active_post_type_setting",active_post_type:i},success:function(t){}})})),t(document).on("change","input.joli-css-unit-input, select.joli-css-unit-values",(function(){var e=t(this).closest(".joli-css-unit-field"),n=t(this).attr("data-linkedfield"),o=t("#joli-css-unit_"+n),i=t(e).find("input.joli-css-unit-input"),a=t(e).find("select.joli-css-unit-values"),r="";""!==t(i).val()&&(r=t(i).val()+"|"+t(a).val()),t(o).val(r||"")})),t(".joli-checkboxes-item > input[type=checkbox]").on("change",(function(e){var n=t(this).closest(".joli-checkboxes-wrap"),o=t(n).find(".joli-checkboxes-item > input[type=checkbox]").map((function(e,n){return t(n).is(":checked")?t(n).val():null})).toArray().filter((function(t,e){return null!==e})).join(","),i=t(this).data("linked-id"),a=t("#"+i);if(!a.length)return!1;t(a).val(o)})),t(".joli-dimensions-lock").on("click",(function(e){t(this).toggleClass("--joli-is-locked")})),t(".joli-dimensions-clear").on("click",(function(e){e.preventDefault();var n=t(this).closest(".joli-dimensions-control").find(".joli-dimension-input");t(n).val("")})),t(".joli-dimension-input").on("input",(function(e){var n=t(this).closest(".joli-dimensions-control").find(".joli-dimensions-lock");if(!n.length)return!1;if(!0===t(n).hasClass("--joli-is-locked")){var o=t(this).closest("ul").find(".joli-dimension-input");if(!o.length)return!1;var i=t(this).val();t(o).each((function(){t(this).val(i)}),i)}})),t("#jtoc-settings").on("submit",(function(e){e.preventDefault();var n=t(".jtoc-wrap"),o=t("#jtoc-save-spinner"),i=t("#jtoc-save-alert");t(n).addClass("joli-is-saving"),t(o).addClass("is-active");var a=t(this).serialize();jQuery.post("options.php",a).done((function(){t(n).removeClass("joli-is-saving"),t(o).removeClass("is-active"),t(i).removeClass("joli-is-hidden"),t(i).show(),setTimeout((function(){t(i).fadeOut(1500,(function(){t(i).addClass("joli-is-hidden")}))}),1500),t(".joli-info-text").removeClass("open")})).fail((function(){alert("Error while saving, please reload the page and try saving again.")})).always((function(){t(n).removeClass("joli-is-saving"),t(o).removeClass("is-active")}))}));var f=t(".joli-content select[data-has-custom-values=1]");f.length&&t(f).each((function(e,n){var o=t(this).attr("data-custom-values-src"),i=t(this).attr("data-selected-value"),a=window[o];if(a.length){var r=this;t(a).each((function(e,n){var o=this.id,a="",s=this.hasOwnProperty("info")?this.info:null;null!==s&&(o=s.hasOwnProperty("name")?s.name:o,a=s.hasOwnProperty("author")?s.author:"");var c=null;i.startsWith("custom-")&&(c=i.substr("custom-".length)),t(r).append(t("<option>",{value:"custom-"+this.id,text:o+" (by "+a+")",selected:c===this.id}))}))}})),t("input:checkbox.joli-checkbox").each((function(t,e){u(this)})),t("#jtoc-import-export").on("click",(function(e){t("#joli-export-import-wrap").toggle()})),t("#joli-export-import-close").on("click",(function(e){t("#joli-export-import-wrap").hide()})),t(".joli-field-info").on("click",(function(e){var n=t(this).next().text();navigator.clipboard.writeText(n)})),t("#jtoc-export-settings").on("click",(function(e){e.preventDefault();var n="undefined"!=typeof jtoc_active_post_type?jtoc_active_post_type:"";t.ajax({url:jtocAdmin.ajaxUrl,method:"post",data:{nonce:jtocAdmin.nonce,action:"joli_toc_export_user_settings",active_post_type:n},success:function(t){!function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}((""===n?"joli-table-of-contents-settings-global":"joli-table-of-contents-settings-"+n)+".json",t.data.settings)}})})),t("#jtoc-import-settings").on("click",(function(e){e.preventDefault();var n="undefined"!=typeof jtoc_active_post_type?jtoc_active_post_type:"",o=document.getElementById("jtoc-import-settings-file").files[0];if(void 0===o)return alert("Please select a file."),!1;var i=new FileReader;i.onload=function(e){var o=i.result;t.ajax({url:jtocAdmin.ajaxUrl,method:"post",data:{nonce:jtocAdmin.nonce,action:"joli_toc_import_user_settings",active_post_type:n,file:o},success:function(t){1==t.data.updated?(alert("Settings imported successfully. Page will reload."),window.location.reload()):alert("Settings were not updated.")}})},i.readAsText(o),i.addEventListener("error",(function(){console.error("Error occurred reading file: ".concat(o.name))}))}));var p=t("#joli-post-type-settings-unlock");t(p).length&&t(p).on("click",(function(e){e.preventDefault(),t("#joli-post-type-tabs-overlay").hide()}))}))}(jQuery);